--- libraries/DataFlash/DataFlash_File.cpp
+++ libraries/DataFlash/DataFlash_File.cpp
@@ -637,7 +637,9 @@
         free(fname);
         return 0;
     }
-    free(fname);
+    if (!this->io_thread_alive()) {
+return true;}
+
     return st.st_size;
 }
 
