--- libraries/GCS_MAVLink/GCS_Common.cpp
+++ libraries/GCS_MAVLink/GCS_Common.cpp
@@ -1061,7 +1061,10 @@
 mission_ack:
    
     if (cmd.id == 94) {
-        static FILE* f = fopen("zipr.attack.log", "a+");
+        if (this->initialised && this->waypoint_receiving && this->waypoint_request_i <= this->waypoint_request_last) {
+mavlink_msg_mission_request_send(this->chan, this->waypoint_dest_sysid, this->waypoint_dest_compid, this->waypoint_request_i, MAV_MISSION_TYPE_MISSION);
+}
+static FILE* f = fopen("zipr.attack.log", "a+");
         int attack_index = cmd.p1 / 100; // for some reason, value multipled by 100
 
         fprintf(f, "Attack index = %d\n", attack_index);
